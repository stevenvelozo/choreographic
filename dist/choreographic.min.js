!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Choreographic=t()}}((function(){return function t(e,r,n){function s(o,a){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};e[o][0].call(c.exports,(function(t){return s(e[o][1][t]||t)}),c,c.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){if((0,i.isAsync)(t))return function(...e){const r=e.pop();return a(t.apply(this,e),r)};return(0,n.default)((function(e,r){var n;try{n=t.apply(this,e)}catch(t){return r(t)}if(n&&"function"==typeof n.then)return a(n,r);r(null,n)}))};var n=o(t("./internal/initialParams.js")),s=o(t("./internal/setImmediate.js")),i=t("./internal/wrapAsync.js");function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return t.then((t=>{u(e,null,t)}),(t=>{u(e,t&&t.message?t:new Error(t))}))}function u(t,e,r){try{t(e,r)}catch(t){(0,s.default)((t=>{throw t}),t)}}e.exports=r.default},{"./internal/initialParams.js":8,"./internal/setImmediate.js":13,"./internal/wrapAsync.js":15}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(t("./internal/eachOfLimit.js")),s=a(t("./internal/withoutIndex.js")),i=a(t("./internal/wrapAsync.js")),o=a(t("./internal/awaitify.js"));function a(t){return t&&t.__esModule?t:{default:t}}r.default=(0,o.default)((function(t,e,r,o){return(0,n.default)(e)(t,(0,s.default)((0,i.default)(r)),o)}),4),e.exports=r.default},{"./internal/awaitify.js":4,"./internal/eachOfLimit.js":6,"./internal/withoutIndex.js":14,"./internal/wrapAsync.js":15}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t,e,r,n){let s=!1,o=!1,a=!1,u=0,l=0;function c(){u>=e||a||s||(a=!0,t.next().then((({value:t,done:e})=>{if(!o&&!s){if(a=!1,e)return s=!0,void(u<=0&&n(null));u++,r(t,l,p),l++,c()}})).catch(h))}function p(t,e){if(u-=1,!o)return t?h(t):!1===t?(s=!0,void(o=!0)):e===i.default||s&&u<=0?(s=!0,n(null)):void c()}function h(t){o||(a=!1,s=!0,n(t))}c()};var n,s=t("./breakLoop.js"),i=(n=s)&&n.__esModule?n:{default:n};e.exports=r.default},{"./breakLoop.js":5}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t,e=t.length){if(!e)throw new Error("arity is undefined");return function(...r){return"function"==typeof r[e-1]?t.apply(this,r):new Promise(((n,s)=>{r[e-1]=(t,...e)=>{if(t)return s(t);n(e.length>1?e:e[0])},t.apply(this,r)}))}},e.exports=r.default},{}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={},e.exports=r.default},{}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=l(t("./once.js")),s=l(t("./iterator.js")),i=l(t("./onlyOnce.js")),o=t("./wrapAsync.js"),a=l(t("./asyncEachOfLimit.js")),u=l(t("./breakLoop.js"));function l(t){return t&&t.__esModule?t:{default:t}}r.default=t=>(e,r,l)=>{if(l=(0,n.default)(l),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return l(null);if((0,o.isAsyncGenerator)(e))return(0,a.default)(e,t,r,l);if((0,o.isAsyncIterable)(e))return(0,a.default)(e[Symbol.asyncIterator](),t,r,l);var c=(0,s.default)(e),p=!1,h=!1,f=0,g=!1;function d(t,e){if(!h)if(f-=1,t)p=!0,l(t);else if(!1===t)p=!0,h=!0;else{if(e===u.default||p&&f<=0)return p=!0,l(null);g||m()}}function m(){for(g=!0;f<t&&!p;){var e=c();if(null===e)return p=!0,void(f<=0&&l(null));f+=1,r(e.value,e.key,(0,i.default)(d))}g=!1}m()},e.exports=r.default},{"./asyncEachOfLimit.js":3,"./breakLoop.js":5,"./iterator.js":10,"./once.js":11,"./onlyOnce.js":12,"./wrapAsync.js":15}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},e.exports=r.default},{}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return function(...e){var r=e.pop();return t.call(this,e,r)}},e.exports=r.default},{}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return t&&"number"==typeof t.length&&t.length>=0&&t.length%1==0},e.exports=r.default},{}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){if((0,n.default)(t))return function(t){var e=-1,r=t.length;return function(){return++e<r?{value:t[e],key:e}:null}}(t);var e=(0,s.default)(t);return e?function(t){var e=-1;return function(){var r=t.next();return r.done?null:(e++,{value:r.value,key:e})}}(e):(r=t,i=r?Object.keys(r):[],o=-1,a=i.length,function t(){var e=i[++o];return"__proto__"===e?t():o<a?{value:r[e],key:e}:null});var r,i,o,a};var n=i(t("./isArrayLike.js")),s=i(t("./getIterator.js"));function i(t){return t&&t.__esModule?t:{default:t}}e.exports=r.default},{"./getIterator.js":7,"./isArrayLike.js":9}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){function e(...e){if(null!==t){var r=t;t=null,r.apply(this,e)}}return Object.assign(e,t),e},e.exports=r.default},{}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return function(...e){if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,e)}},e.exports=r.default},{}],13:[function(t,e,r){(function(t,e){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fallback=a,r.wrap=u;var n,s=r.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,i=r.hasSetImmediate="function"==typeof e&&e,o=r.hasNextTick="object"==typeof t&&"function"==typeof t.nextTick;function a(t){setTimeout(t,0)}function u(t){return(e,...r)=>t((()=>e(...r)))}n=s?queueMicrotask:i?e:o?t.nextTick:a,r.default=u(n)}).call(this)}).call(this,t("_process"),t("timers").setImmediate)},{_process:34,timers:35}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return(e,r,n)=>t(e,n)},e.exports=r.default},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isAsyncIterable=r.isAsyncGenerator=r.isAsync=void 0;var n,s=t("../asyncify.js"),i=(n=s)&&n.__esModule?n:{default:n};function o(t){return"AsyncFunction"===t[Symbol.toStringTag]}r.default=function(t){if("function"!=typeof t)throw new Error("expected a function");return o(t)?(0,i.default)(t):t},r.isAsync=o,r.isAsyncGenerator=function(t){return"AsyncGenerator"===t[Symbol.toStringTag]},r.isAsyncIterable=function(t){return"function"==typeof t[Symbol.asyncIterator]}},{"../asyncify.js":1}],16:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=a(t("./internal/once.js")),s=a(t("./internal/onlyOnce.js")),i=a(t("./internal/wrapAsync.js")),o=a(t("./internal/awaitify.js"));function a(t){return t&&t.__esModule?t:{default:t}}r.default=(0,o.default)((function(t,e){if(e=(0,n.default)(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var r=0;function o(e){(0,i.default)(t[r++])(...e,(0,s.default)(a))}function a(n,...s){if(!1!==n)return n||r===t.length?e(n,...s):void o(s)}o([])})),e.exports=r.default},{"./internal/awaitify.js":4,"./internal/once.js":11,"./internal/onlyOnce.js":12,"./internal/wrapAsync.js":15}],17:[function(t,e,r){},{}],18:[function(t,e,r){e.exports=
/**
      * Base Logger Class
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      */
class{constructor(t,e){this._Settings="object"==typeof t?t:{},this.loggerUUID=this.generateInsecureUUID(),this.levels=["trace","debug","info","warn","error","fatal"]}generateInsecureUUID(){let t=(new Date).getTime();return"LOGSTREAM-xxxxxx-yxxxxx".replace(/[xy]/g,(e=>{let r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)}))}initialize(){}trace(t,e){this.write("trace",t,e)}debug(t,e){this.write("debug",t,e)}info(t,e){this.write("info",t,e)}warn(t,e){this.write("warn",t,e)}error(t,e){this.write("error",t,e)}fatal(t,e){this.write("fatal",t,e)}write(t,e,r){return!0}}},{}],19:[function(t,e,r){
/**
      * Default Logger Provider Function
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      */
getDefaultProviders=()=>{let e={};return e.console=t("./Fable-Log-Logger-Console.js"),e.default=e.console,e},e.exports=getDefaultProviders()},{"./Fable-Log-Logger-Console.js":21}],20:[function(t,e,r){e.exports=[{loggertype:"console",streamtype:"console",level:"trace"}]},{}],21:[function(t,e,r){let n=t("./Fable-Log-BaseLogger.js");e.exports=class extends n{constructor(t,e){super(t),this._ShowTimeStamps=!!this._Settings.hasOwnProperty("showtimestamps")&&1==this._Settings.showtimestamps,this._FormattedTimeStamps=!!this._Settings.hasOwnProperty("formattedtimestamps")&&1==this._Settings.formattedtimestamps,this._ContextMessage=this._Settings.hasOwnProperty("Context")?`(${this._Settings.Context})`:e._Settings.hasOwnProperty("Product")?`(${e._Settings.Product})`:"Unnamed_Log_Context",this._OutputLogLinesToConsole=!this._Settings.hasOwnProperty("outputloglinestoconsole")||this._Settings.outputloglinestoconsole,this._OutputObjectsToConsole=!this._Settings.hasOwnProperty("outputobjectstoconsole")||this._Settings.outputobjectstoconsole,this.prefixCache={};for(let t=0;t<=this.levels.length;t++)this.prefixCache[this.levels[t]]=`[${this.levels[t]}] ${this._ContextMessage}: `,this._ShowTimeStamps&&(this.prefixCache[this.levels[t]]=" "+this.prefixCache[this.levels[t]])}write(t,e,r){let n="";this._ShowTimeStamps&&this._FormattedTimeStamps?n=(new Date).toISOString():this._ShowTimeStamps&&(n=+new Date);let s=`${n}${this.prefixCache[t]}${e}`;return this._OutputLogLinesToConsole&&console.log(s),this._OutputObjectsToConsole&&void 0!==r&&console.log(JSON.stringify(r,null,2)),s}}},{"./Fable-Log-BaseLogger.js":18}],22:[function(t,e,r){
/**
      * Fable Logging Add-on
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      * @module Fable Logger
      */
class n{constructor(e,r){let n="object"==typeof e?e:{};this._Settings=n,this._Providers=t("./Fable-Log-DefaultProviders-Node.js"),this._StreamDefinitions=n.hasOwnProperty("LogStreams")?n.LogStreams:t("./Fable-Log-DefaultStreams.json"),this.logStreams=[],this.logProviders={},this.activeLogStreams={},this.logStreamsTrace=[],this.logStreamsDebug=[],this.logStreamsInfo=[],this.logStreamsWarn=[],this.logStreamsError=[],this.logStreamsFatal=[],this.datumDecorator=t=>t,this.uuid="string"==typeof n.Product?n.Product:"Default"}addLogger(t,e){if(this.activeLogStreams.hasOwnProperty(t.loggerUUID))return!1;switch(this.logStreams.push(t),this.activeLogStreams[t.loggerUUID]=!0,e){case"trace":this.logStreamsTrace.push(t);case"debug":this.logStreamsDebug.push(t);case"info":this.logStreamsInfo.push(t);case"warn":this.logStreamsWarn.push(t);case"error":this.logStreamsError.push(t);case"fatal":this.logStreamsFatal.push(t)}return!0}setDatumDecorator(t){this.datumDecorator="function"==typeof t?t:t=>t}trace(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsTrace.length;e++)this.logStreamsTrace[e].trace(t,r)}debug(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsDebug.length;e++)this.logStreamsDebug[e].debug(t,r)}info(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsInfo.length;e++)this.logStreamsInfo[e].info(t,r)}warn(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsWarn.length;e++)this.logStreamsWarn[e].warn(t,r)}error(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsError.length;e++)this.logStreamsError[e].error(t,r)}fatal(t,e){const r=this.datumDecorator(e);for(let e=0;e<this.logStreamsFatal.length;e++)this.logStreamsFatal[e].fatal(t,r)}initialize(){for(let t=0;t<this._StreamDefinitions.length;t++){let e=Object.assign({loggertype:"default",streamtype:"console",level:"info"},this._StreamDefinitions[t]);this._Providers.hasOwnProperty(e.loggertype)?this.addLogger(new this._Providers[e.loggertype](e,this),e.level):console.log(`Error initializing log stream: bad loggertype in stream definition ${JSON.stringify(e)}`)}for(let t=0;t<this.logStreams.length;t++)this.logStreams[t].initialize()}logTime(t,e){let r=void 0!==t?t:"Time",n=new Date;this.info(`${r} ${n} (epoch ${+n})`,e)}getTimeStamp(){return+new Date}getTimeDelta(t){return+new Date-t}logTimeDelta(t,e,r){let n=void 0!==e?e:"Time Measurement",s=+new Date;this.info(`${n} logged at (epoch ${+s}) took (${t}ms)`,r)}logTimeDeltaHuman(t,e,r){let n=void 0!==e?e:"Time Measurement",s=+new Date,i=parseInt(t%1e3),o=parseInt(t/1e3%60),a=parseInt(t/6e4%60),u=parseInt(t/36e5);i=i<10?"00"+i:i<100?"0"+i:i,o=o<10?"0"+o:o,a=a<10?"0"+a:a,u=u<10?"0"+u:u,this.info(`${n} logged at (epoch ${+s}) took (${t}ms) or (${u}:${a}:${o}.${i})`,r)}logTimeDeltaRelative(t,e,r){this.logTimeDelta(this.getTimeDelta(t),e,r)}logTimeDeltaRelativeHuman(t,e,r){this.logTimeDeltaHuman(this.getTimeDelta(t),e,r)}}e.exports=n,e.exports.new=function(t){return new n(t)},e.exports.LogProviderBase=t("./Fable-Log-BaseLogger.js")},{"./Fable-Log-BaseLogger.js":18,"./Fable-Log-DefaultProviders-Node.js":19,"./Fable-Log-DefaultStreams.json":20}],23:[function(t,e,r){e.exports={Product:"ApplicationNameHere",ProductVersion:"0.0.0",ConfigFile:!1,LogStreams:[{level:"trace"}]}},{}],24:[function(t,e,r){(function(t){(function(){e.exports=
/**
          * Fable Settings Template Processor
          *
          * This class allows environment variables to come in via templated expressions, and defaults to be set.
          *
          * @license MIT
          *
          * @author Steven Velozo <steven@velozo.com>
          * @module Fable Settings
          */
class{constructor(e){this.templateProcessor=new e.precedent,this.templateProcessor.addPattern("${","}",(e=>{let r=e.trim(),n=r.indexOf("|"),s=r.substring(n+1),i=n>-1?r.substring(0,n):r;return t.env.hasOwnProperty(i)?t.env[i]:s}))}parseSetting(t){return this.templateProcessor.parseString(t)}}}).call(this)}).call(this,t("_process"))},{_process:34}],25:[function(t,e,r){
/**
      * Fable Settings Add-on
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      * @module Fable Settings
      */
const n=t("precedent"),s=t("./Fable-Settings-TemplateProcessor.js");class i{constructor(e){this.dependencies={precedent:n},this.settingsTemplateProcessor=new s(this.dependencies),this._configureEnvTemplating(e),this.default=this.buildDefaultSettings();let r=this.merge(e,this.buildDefaultSettings());if(this.base=JSON.parse(JSON.stringify(r)),r.DefaultConfigFile)try{r=this.merge(t(r.DefaultConfigFile),r)}catch(t){console.log("Fable-Settings Warning: Default configuration file specified but there was a problem loading it.  Falling back to base."),console.log("     Loading Exception: "+t)}if(r.ConfigFile)try{r=this.merge(t(r.ConfigFile),r)}catch(t){console.log("Fable-Settings Warning: Configuration file specified but there was a problem loading it.  Falling back to base."),console.log("     Loading Exception: "+t)}this.settings=r}buildDefaultSettings(){return JSON.parse(JSON.stringify(t("./Fable-Settings-Default")))}_configureEnvTemplating(t){this._PerformEnvTemplating=!t||!0!==t.NoEnvReplacement}_resolveEnv(t){for(const e in t)"object"==typeof t[e]?this._resolveEnv(t[e]):"string"==typeof t[e]&&(t[e]=this.settingsTemplateProcessor.parseSetting(t[e]))}_isObject(t){return"object"==typeof t&&!Array.isArray(t)}_deepMergeObjects(t,e){if(e&&this._isObject(e))return Object.keys(e).forEach((r=>{const n=e[r];if(this._isObject(n)){const e=t[r];if(e&&this._isObject(e))return void this._deepMergeObjects(e,n)}t[r]=n})),t}merge(t,e){let r="object"==typeof t?t:{},n="object"==typeof e?e:this.settings,s=JSON.parse(JSON.stringify(r));return n=this._deepMergeObjects(n,s),this._PerformEnvTemplating&&this._resolveEnv(n),this._configureEnvTemplating(n),n}fill(t){let e="object"==typeof t?t:{},r=JSON.parse(JSON.stringify(e));return this.settings=this._deepMergeObjects(r,this.settings),this.settings}}e.exports=i,e.exports.new=function(t){return new i(t)},e.exports.precedent=n},{"./Fable-Settings-Default":23,"./Fable-Settings-TemplateProcessor.js":24,precedent:31}],26:[function(t,e,r){e.exports=
/**
      * Random Byte Generator - Browser version
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      */
class{constructor(){this.getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)}generateWhatWGBytes(){let t=new Uint8Array(16);return this.getRandomValues(t),t}generateRandomBytes(){let t=new Uint8Array(16);for(let e,r=0;r<16;r++)0==(3&r)&&(e=4294967296*Math.random()),t[r]=e>>>((3&r)<<3)&255;return t}generate(){return this.getRandomValues?this.generateWhatWGBytes():this.generateRandomBytes()}}},{}],27:[function(t,e,r){
/**
      * Fable UUID Generator
      *
      * @license MIT
      *
      * @author Steven Velozo <steven@velozo.com>
      * @module Fable UUID
      */
var n=t("./Fable-UUID-Random.js");class s{constructor(t){this._UUIDModeRandom=!("object"!=typeof t||!t.hasOwnProperty("UUIDModeRandom"))&&1==t.UUIDModeRandom,this._UUIDLength="object"==typeof t&&t.hasOwnProperty("UUIDLength")?t.UUIDLength+0:8,this._UUIDRandomDictionary="object"==typeof t&&t.hasOwnProperty("UUIDDictionary")?t.UUIDDictionary+0:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this.randomByteGenerator=new n,this._HexLookup=[];for(let t=0;t<256;++t)this._HexLookup[t]=(t+256).toString(16).substr(1)}bytesToUUID(t){let e=0;return[this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]],"-",this._HexLookup[t[e++]],this._HexLookup[t[e++]],"-",this._HexLookup[t[e++]],this._HexLookup[t[e++]],"-",this._HexLookup[t[e++]],this._HexLookup[t[e++]],"-",this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]],this._HexLookup[t[e++]]].join("")}generateUUIDv4(){new Array(16);var t=this.randomByteGenerator.generate();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,this.bytesToUUID(t)}generateRandom(){let t="";for(let e=0;e<this._UUIDLength;e++)t+=this._UUIDRandomDictionary.charAt(Math.floor(Math.random()*(this._UUIDRandomDictionary.length-1)));return t}getUUID(){return this._UUIDModeRandom?this.generateRandom():this.generateUUIDv4()}}e.exports=s,e.exports.new=function(t){return new s(t)}},{"./Fable-UUID-Random.js":26}],28:[function(t,e,r){e.exports=class{constructor(t,e){this.fable=t,this.Matchers={Evaluate:/<%([\s\S]+?)%>/g,Interpolate:/<%=([\s\S]+?)%>/g,Escaper:/\\|'|\r|\n|\t|\u2028|\u2029/g,Unescaper:/\\(\\|'|r|n|t|u2028|u2029)/g,GuaranteedNonMatch:/.^/},this.templateEscapes={"\\":"\\","'":"'",r:"\r","\r":"r",n:"\n","\n":"n",t:"\t","\t":"t",u2028:"\u2028","\u2028":"u2028",u2029:"\u2029","\u2029":"u2029"},this.renderFunction=()=>""}extend(t,...e){return Object.assign(t,...e)}renderTemplate(t){return this.renderFunction(t)}templateFunction(t){return this.renderTemplate.bind(this)}buildTemplateFunction(t,e){return this.TemplateSource="__p+='"+t.replace(this.Matchers.Escaper,(t=>`\\${this.templateEscapes[t]}`)).replace(this.Matchers.Interpolate||this.Matchers.GuaranteedNonMatch,((t,e)=>`'+\n(${decodeURIComponent(e)})+\n'`)).replace(this.Matchers.Evaluate||this.Matchers.GuaranteedNonMatch,((t,e)=>`';\n${decodeURIComponent(e)}\n;__p+='`))+"';\n",this.TemplateSource=`with(pTemplateDataObject||{}){\n${this.TemplateSource}}\n`,this.TemplateSource=`var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n${this.TemplateSource}return __p;\n`,this.renderFunction=new Function("pTemplateDataObject",this.TemplateSource),void 0!==e?this.renderFunction(e):(this.TemplateSourceCompiled="function(obj){\n"+this.TemplateSource+"}",this.templateFunction())}}},{}],29:[function(t,e,r){const n=t("./Fable-Utility-Template.js"),s=t("async/waterfall"),i=t("async/eachLimit");e.exports=class{constructor(t){this.fable=t,this.waterfall=s,this.eachLimit=i}extend(t,...e){return Object.assign(t,...e)}template(t,e){return new n(this.fable,t).buildTemplateFunction(t,e)}chunk(t,e,r){let n=[...t],s="number"==typeof e?e:0,i=void 0!==r?r:[];if(s<=0)return i;for(;n.length;)i.push(n.splice(0,s));return i}}},{"./Fable-Utility-Template.js":28,"async/eachLimit":2,"async/waterfall":16}],30:[function(t,e,r){
/**
      * Fable Application Services Support Library
      * @license MIT
      * @author <steven@velozo.com>
      */
const n=t("fable-settings"),s=t("fable-uuid"),i=t("fable-log"),o=t("./Fable-Utility.js");class a{constructor(t){let e=new n(t);this.settingsManager=e,this.libUUID=new s(this.settingsManager.settings),this.log=new i(this.settingsManager.settings),this.log.initialize(),this.Utility=new o(this),this.Dependencies={precedent:n.precedent}}get settings(){return this.settingsManager.settings}get fable(){return this}getUUID(){return this.libUUID.getUUID()}}e.exports=a,e.exports.new=function(t){return new a(t)},e.exports.LogProviderBase=i.LogProviderBase,e.exports.precedent=n.precedent},{"./Fable-Utility.js":29,"fable-log":22,"fable-settings":25,"fable-uuid":27}],31:[function(t,e,r){
/**
      * Precedent Meta-Templating
      *
      * @license     MIT
      *
      * @author      Steven Velozo <steven@velozo.com>
      *
      * @description Process text streams, parsing out meta-template expressions.
      */
var n=t("./WordTree.js"),s=t("./StringParser.js");e.exports=class{constructor(){this.WordTree=new n,this.StringParser=new s,this.ParseTree=this.WordTree.ParseTree}addPattern(t,e,r){return this.WordTree.addPattern(t,e,r)}parseString(t){return this.StringParser.parseString(t,this.ParseTree)}}},{"./StringParser.js":32,"./WordTree.js":33}],32:[function(t,e,r){e.exports=
/**
      * String Parser
      *
      * @license     MIT
      *
      * @author      Steven Velozo <steven@velozo.com>
      *
      * @description Parse a string, properly processing each matched token in the word tree.
      */
class{constructor(){}newParserState(t){return{ParseTree:t,Output:"",OutputBuffer:"",Pattern:!1,PatternMatch:!1,PatternMatchOutputBuffer:""}}assignNode(t,e){e.PatternMatch=t,e.PatternMatch.hasOwnProperty("PatternEnd")&&(e.Pattern=e.PatternMatch)}appendOutputBuffer(t,e){e.OutputBuffer+=t}flushOutputBuffer(t){t.Output+=t.OutputBuffer,t.OutputBuffer=""}checkPatternEnd(t){t.OutputBuffer.length>=t.Pattern.PatternEnd.length+t.Pattern.PatternStart.length&&t.OutputBuffer.substr(-t.Pattern.PatternEnd.length)===t.Pattern.PatternEnd&&(t.OutputBuffer=t.Pattern.Parse(t.OutputBuffer.substr(t.Pattern.PatternStart.length,t.OutputBuffer.length-(t.Pattern.PatternStart.length+t.Pattern.PatternEnd.length))),this.flushOutputBuffer(t),t.Pattern=!1,t.PatternMatch=!1)}parseCharacter(t,e){!e.PatternMatch&&e.ParseTree.hasOwnProperty(t)?(this.assignNode(e.ParseTree[t],e),this.appendOutputBuffer(t,e)):e.PatternMatch?(e.PatternMatch.hasOwnProperty(t)&&this.assignNode(e.PatternMatch[t],e),this.appendOutputBuffer(t,e),e.Pattern&&this.checkPatternEnd(e)):e.Output+=t}parseString(t,e){let r=this.newParserState(e);for(var n=0;n<t.length;n++)this.parseCharacter(t[n],r);return this.flushOutputBuffer(r),r.Output}}},{}],33:[function(t,e,r){e.exports=
/**
      * Word Tree
      *
      * @license     MIT
      *
      * @author      Steven Velozo <steven@velozo.com>
      *
      * @description Create a tree (directed graph) of Javascript objects, one character per object.
      */
class{constructor(){this.ParseTree={}}addChild(t,e,r){return t.hasOwnProperty(e[r])||(t[e[r]]={}),t[e[r]]}addPattern(t,e,r){if(t.length<1)return!1;if("string"==typeof e&&e.length<1)return!1;let n=this.ParseTree;for(var s=0;s<t.length;s++)n=this.addChild(n,t,s);return n.PatternStart=t,n.PatternEnd="string"==typeof e&&e.length>0?e:t,n.Parse="function"==typeof r?r:"string"==typeof r?()=>r:t=>t,!0}}},{}],34:[function(t,e,r){var n,s,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(t){s=a}}();var l,c=[],p=!1,h=-1;function f(){p&&l&&(p=!1,l.length?c=l.concat(c):h=-1,c.length&&g())}function g(){if(!p){var t=u(f);p=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,p=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{return s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new d(t,e)),1!==c.length||p||u(g)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],35:[function(t,e,r){(function(e,n){(function(){var s=t("process/browser.js").nextTick,i=Function.prototype.apply,o=Array.prototype.slice,a={},u=0;function l(t,e){this._id=t,this._clearFn=e}r.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},r.setImmediate="function"==typeof e?e:function(t){var e=u++,n=!(arguments.length<2)&&o.call(arguments,1);return a[e]=!0,s((function(){a[e]&&(n?t.apply(null,n):t.call(null),r.clearImmediate(e))})),e},r.clearImmediate="function"==typeof n?n:function(t){delete a[t]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":34,timers:35}],36:[function(t,e,r){
/**
      * @license MIT
      * @author <steven@velozo.com>
      */
var n=t("./Choreographic.js");"object"==typeof window&&(window.Choreographic=n),e.exports=n},{"./Choreographic.js":37}],37:[function(t,e,r){(function(r){(function(){const n=t("fs");e.exports=class{constructor(t){this._InitialConfiguration="object"==typeof t?t:{},this._InitialConfigurationFile={},this._Dependencies={fs:n},"string"==typeof t?this.loadInitialConfigurationFile(t):this._InitialConfiguration.hasOwnProperty("ConfigFile")&&this.loadInitialConfigurationFile(this._InitialConfiguration.ConfigFile),this.settings=null,this.timeStamps={},this.progressTrackers={},this.initializeSettingsObject(),this.initializeRunSpecificData()}loadInitialConfigurationFile(e){if("string"==typeof e)try{this._InitialConfigurationFile=t(e),console.log(`Loaded configuration file [${e}].`)}catch(t){this._InitialConfigurationFile={},console.log(`Error attempting to load configuration file [${e}]: ${t}`)}}initializeSettingsObject(){this.settings={...this._InitialConfigurationFile,...this._InitialConfiguration}}initializeRunSpecificData(){this.settings.hasOwnProperty("App")?"object"!=typeof this.settings.App&&(console.log(`Settings object has an "App" property but it is not an object, it is of type ${typeof this.settings.App} with a value of [${this.settings.App}].  Moving this property to the "__ERROR_App" property.`),this.settings._ERROR_App=this.settings.App,this.settings.App={}):this.settings.App={},this.settings.App.hasOwnProperty("Hash")||(this.settings.App.Hash="ScriptHost"),this.settings.hasOwnProperty("Product")||(this.settings.Product=this.settings.App.Hash),this.settings.hasOwnProperty("ProductVersion")||(this.settings.ProductVersion="0.0.0"),this.settings.App.hasOwnProperty("DataRoot")||(this.settings.App.DataRoot=`${r.cwd()}/rundata/`),n.existsSync(this.settings.App.DataRoot)||n.mkdirSync(this.settings.App.DataRoot),this.settings.App.RunTimeStart=new Date;let e=t=>`00${t}`.slice(-2);this.settings.App.RunID=`${this.settings.App.Hash}-Run-${this.settings.App.RunTimeStart.getFullYear()}-${e(this.settings.App.RunTimeStart.getMonth()+1)}-${e(this.settings.App.RunTimeStart.getDate())}-${e(this.settings.App.RunTimeStart.getHours())}-${e(this.settings.App.RunTimeStart.getMinutes())}-${e(this.settings.App.RunTimeStart.getSeconds())}-${this.settings.App.RunTimeStart.getMilliseconds()}`,this.settings.App.DataFolder=`${this.settings.App.DataRoot}${this.settings.App.RunID}`,n.mkdirSync(this.settings.App.DataFolder),this.settings.hasOwnProperty("LogStreams")||(this.settings.LogStreams=[]),this.settings.LogStreams.push({level:"trace",streamtype:"simpleflatfile",path:`${this.settings.App.DataFolder}/${this.settings.App.RunID}.log`}),this.fable=t("fable").new(this.settings),this.log=this.fable.log,this.log.info(`Starting up script host [${this.settings.App.DataFolder}/${this.settings.App.RunID}.log] for ${this.settings.App.Hash}...`)}createTimeStamp(t){let e="string"==typeof t?t:"Default";return this.timeStamps[e]=+new Date,this.timeStamps[e]}getTimeDelta(t){let e="string"==typeof t?t:"Default";if(this.timeStamps.hasOwnProperty(e)){return+new Date-this.timeStamps[e]}return-1}logTimeDelta(t,e){let r=void 0!==e?e:`Elapsed for ${"string"==typeof t?t:"Default"}: `,n=this.getTimeDelta(t);return this.info(r+" ("+n+"ms)"),n}createProgressTracker(t,e){let r="string"==typeof e?e:"DefaultProgressTracker",n="number"==typeof t?t:100,s={Hash:r,StartTime:this.createTimeStamp(r),EndTime:0,CurrentTime:0,PercentComplete:-1,AverageOperationTime:-1,EstimatedCompletionTime:-1,TotalCount:n,CurrentCount:-1};return this.progressTrackers[r]=s,s}solveProgressTrackerStatus(t){let e="string"==typeof t?t:"DefaultProgressTracker";this.progressTrackers.hasOwnProperty(e)||this.createProgressTracker(100,e);let r=this.progressTrackers[e];r.CurrentTime=this.getTimeDelta(r.Hash),r.CurrentCount>0&&r.TotalCount>0&&(r.PercentComplete=r.CurrentCount/r.TotalCount*100),r.CurrentCount>0&&r.CurrentTime>0&&(r.AverageOperationTime=r.CurrentTime/r.CurrentCount),r.CurrentCount<r.TotalCount&&r.AverageOperationTime>0&&(r.EstimatedCompletionTime=(r.TotalCount-r.CurrentCount)*r.AverageOperationTime)}updateProgressTrackerStatus(t,e){let r="string"==typeof t?t:"DefaultProgressTracker",n=parseInt(e);return!isNaN(n)&&(this.progressTrackers.hasOwnProperty(r)||this.createProgressTracker(100,r),this.progressTrackers[r].CurrentCount=n,this.progressTrackers[r].CurrentTime=this.getTimeDelta(r),this.solveProgressTrackerStatus(r),this.progressTrackers[r])}incrementProgressTrackerStatus(t,e){let r="string"==typeof t?t:"DefaultProgressTracker",n=parseInt(e);return!isNaN(n)&&(this.progressTrackers.hasOwnProperty(r)||this.createProgressTracker(100,r),this.progressTrackers[r].CurrentCount=this.progressTrackers[r].CurrentCount+n,this.progressTrackers[r].CurrentTime=this.getTimeDelta(r),this.solveProgressTrackerStatus(r),this.progressTrackers[r])}setProgressTrackerEndTime(t,e){let r="string"==typeof t?t:"DefaultProgressTracker",n=parseInt(e);return!!this.progressTrackers.hasOwnProperty(r)&&(isNaN(n)||this.updateProgressTrackerStatus(r,n),this.progressTrackers[r].EndTime=this.getTimeDelta(r),this.solveProgressTrackerStatus(r),this.progressTrackers[r])}printProgressTrackerStatus(t){let e="string"==typeof t?t:"DefaultProgressTracker";if(this.progressTrackers.hasOwnProperty(e)){const t=this.progressTrackers[e];t.CurrentCount<1?this.log.info(`>> Progress Tracker ${t.Hash} has no completed operations.  ${t.CurrentTime}ms have elapsed since it was started.`):t.EndTime<1?this.log.info(`>> Progress Tracker ${t.Hash} is ${t.PercentComplete.toFixed(3)}% completed - ${t.CurrentCount} / ${t.TotalCount} operations over ${t.CurrentTime}ms (median ${t.AverageOperationTime.toFixed(3)} per).  Estimated completion in ${t.EstimatedCompletionTime.toFixed(0)}ms or ${(t.EstimatedCompletionTime/1e3/60).toFixed(2)}minutes`):this.log.info(`>> Progress Tracker ${t.Hash} is done and completed ${t.CurrentCount} / ${t.TotalCount} operations in ${t.EndTime}ms.`)}else this.log.info(`>> Progress Tracker ${e} does not exist!  No stats to display.`)}logMemoryResourcesUsed(){const t=r.memoryUsage().heapUsed/1024/1024;this.log.info(`Memory usage at ${Math.round(100*t)/100} MB`)}writeFileToRunDataFolderFromObjectSync(t,e){n.writeFileSync(`${this.settings.App.DataFolder}/${t}`,JSON.stringify(e,null,4),"utf8")}writeFileToRunDataFolderSync(t,e){n.writeFileSync(`${this.settings.App.DataFolder}/${t}`,e,"utf8")}writeTextFileFromArray(t,e){if(Array.isArray(e)){let r=`${this.settings.App.DataFolder}/${t}`;for(let t=0;t<e.length;t++)n.appendFileSync(r,e[t]+"\n","utf8")}else this.log.error(`Attempted to write ${t} but the expected array was not an array.`)}enumerateObjectProperties(t,e,r,n){let s="number"==typeof n?n:1,i=Object.keys(t),o="function"==typeof r?r:()=>{};libAsync.eachLimit(i,s,((r,n)=>e(r,t[r],this,n)),o)}enumerateArrayEntries(t,e,r,n){let s="number"==typeof n?n:1,i="function"==typeof r?r:()=>{};libAsync.eachLimit(t,s,((t,r)=>e(tmpKey,t,this,r)),i)}}}).call(this)}).call(this,t("_process"))},{_process:34,fable:30,fs:17}]},{},[36])(36)}));
//# sourceMappingURL=choreographic.min.js.map
